<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<body>
    <div class="form-container" th:fragment="content">
        <!-- Encabezado del formulario -->
        <div class="form-header">
            <i class="fas fa-user-plus fa-2x mb-2"></i>
            <h2>Crear Nuevo Usuario</h2>
            <p class="form-subtitle">Complete la información para registrar un nuevo usuario</p>
        </div>
        <!-- Mensaje de exito-->
        <div th:if="${successMensage}" class="alert alert-success d-flex align-items-center" role="alert">
            <i class="fas fa-check-circle m2-2"></i>
            <span th:text="${successMensage}"></span>
        </div>
        <!-- Mensaje de error -->
        <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
            <i class="fas fa-exclamation-circle"></i>
            <span th:text="${errorMessage}"></span>
        </div>
        <!-- Formulario -->
        <form method="post" th:action="@{/usuarios/create}" th:object="${usuarioDto}" id="usuarioForm">
            <!-- Información Personal -->
            <h3 class="section-title">Información Personal</h3>
            
            <div class="row row-group mb-3">
                <div class="col-md-6 mb-3">
                    <label class="form-label required">Nombre</label>
                    <div class="input-with-icon">
                        <i class="fas fa-user"></i>
                        <input type="text" class="form-control" th:field="*{nombre}" 
                               placeholder="Ingrese el nombre" required>
                    </div>
                    <div class="text-danger" th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}"></div>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label required">Apellido</label>
                    <div class="input-with-icon">
                        <i class="fas fa-user"></i>
                        <input type="text" class="form-control" th:field="*{apellido}" 
                               placeholder="Ingrese el apellido" required>
                    </div>
                    <div class="text-danger" th:if="${#fields.hasErrors('apellido')}" th:errors="*{apellido}"></div>
                </div>
            </div>

            <!-- Sexo y DNI en línea -->
            <div class="row compact-row mb-3">
                <div class="col-md-6 mb-3">
                    <label class="form-label required">Sexo</label><br>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" th:field="*{sexo}" value="M" id="sexoM">
                        <label class="form-check-label" for="sexoM">Masculino</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" th:field="*{sexo}" value="F" id="sexoF">
                        <label class="form-check-label" for="sexoF">Femenino</label>
                    </div>
                    <div class="text-danger" th:if="${#fields.hasErrors('sexo')}" th:errors="*{sexo}"></div>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label required">DNI</label>
                    <div class="input-with-icon">
                        <i class="fas fa-id-card"></i>
                        <input type="text" class="form-control" th:field="*{nroDocumento}" 
                               placeholder="Número de documento" required
                               maxlength="8" pattern="[0-9]{8}">
                    </div>
                    <div class="text-danger" th:if="${#fields.hasErrors('nroDocumento')}" th:errors="*{nroDocumento}"></div>
                </div>
            </div>

            <!-- Fecha de Nacimiento -->
            <div class="mb-3">
                <label class="form-label required">Fecha de Nacimiento</label>
                <div class="input-with-icon">
                    <i class="fas fa-calendar-alt"></i>
                    <input type="date" class="form-control" th:field="*{fechaNacimiento}" required>
                </div>
                <div class="text-danger" th:if="${#fields.hasErrors('fechaNacimiento')}" th:errors="*{fechaNacimiento}"></div>
            </div>

            <!-- Información de Acceso -->
            <h3 class="section-title">Información de Acceso</h3>

            <!-- Nombre de Usuario -->
            <div class="mb-3">
                <label class="form-label required">Nombre de Usuario</label>
                <div class="input-with-icon">
                    <i class="fas fa-at"></i>
                    <input type="text" class="form-control" th:field="*{nombreUsuario}" 
                           placeholder="Ingrese el nombre de usuario" required>
                </div>
                <div class="text-danger" th:if="${#fields.hasErrors('nombreUsuario')}" th:errors="*{nombreUsuario}"></div>
            </div>

            <!-- Rol y Contraseña en línea -->
            <div class="row compact-row mb-3">
                <div class="col-md-6 mb-3">
                    <label class="form-label required">
                        <span class="combo-label">
                            <i class="fas fa-user-tag"></i> Rol
                        </span>
                    </label>
                    <select class="form-select" th:field="*{rol}" required>
                        <option value="">Seleccione rol</option>
                        <option th:each="rol : ${roles}" 
                                th:value="${rol}" 
                                th:text="${rol}"></option>
                    </select>
                    <div class="text-danger" th:if="${#fields.hasErrors('rol')}" th:errors="*{rol}"></div>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label required">Contraseña</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock"></i>
                        <input type="password" class="form-control" id="password" th:field="*{password}" 
                               placeholder="Contraseña" required
                               onkeyup="checkPasswordStrength(this.value)">
                    </div>
                    <div class="password-strength">
                        <div class="password-strength-bar" id="password-strength-bar"></div>
                    </div>
                </div>
            </div>

            <!-- Confirmar Contraseña -->
            <div class="mb-3">
                <label class="form-label required">Confirmar Contraseña</label>
                <div class="input-with-icon">
                    <i class="fas fa-lock"></i>
                    <input type="password" class="form-control" id="confirmPassword" 
                           placeholder="Confirme la contraseña" required
                           onkeyup="checkPasswordMatch()">
                </div>
                <div class="text-danger" id="password-match-error" style="display: none;">
                    <i class="fas fa-exclamation-circle"></i> Las contraseñas no coinciden
                </div>
                <div class="password-requirements">
                    <div class="requirement unmet" id="req-length">
                        <i class="fas fa-circle"></i> Mínimo 8 caracteres
                    </div>
                    <div class="requirement unmet" id="req-upper">
                        <i class="fas fa-circle"></i> Una letra mayúscula
                    </div>
                    <div class="requirement unmet" id="req-lower">
                        <i class="fas fa-circle"></i> Una letra minúscula
                    </div>
                    <div class="requirement unmet" id="req-number">
                        <i class="fas fa-circle"></i> Un número
                    </div>
                </div>
            </div>

            <!-- Botones de acción -->
            <div class="form-actions d-flex justify-content-end gap-2">
                <a th:href="@{/dashboard}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left"></i> Cancelar
                </a>
                <button type="submit" class="btn btn-primary" id="submit-btn">
                    <i class="fas fa-save"></i> Guardar Usuario
                </button>
            </div>
        </form>
        <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>
    </div>

</body>
</html>